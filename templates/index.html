<!doctype html>
<html>
  <head>
    <title>Disk Info</title>
    <link rel="stylesheet" type="text/css" href="/static/styles.css" />
  </head>
  <body>
    <h1>Disk Information</h1>
    <div class="view-switch">
      <a href="/?view=table" class="button">Table View</a>
      <a href="/?view=round" class="button">Round Cakes View</a>
      <a href="/?view=columns" class="button">Columns View</a>
    </div>
    {{if eq .View "table"}}
    <table class="disk-table">
      <tr>
        <th>Device</th>
        <th>Total Size</th>
        <th>Used</th>
        <th>Free</th>
        <th>Ignore</th>
      </tr>
      {{range .DiskInfos}}
      <tr>
        <td>{{.Device}}</td>
        <td>{{.HumanSize}}</td>
        <td>{{.HumanUsed}}</td>
        <td>{{.HumanFree}}</td>
        <td>{{if .Ignore}}Yes{{else}}No{{end}}</td>
      </tr>
      {{end}}
    </table>
    {{else if eq .View "round"}}
    <div class="disks">
      {{range .DiskInfos}}
      <div class="disk {{if .Ignore}}ignore{{end}}">
        <div class="disk-name">{{.Device}}</div>
        <svg width="100" height="100" viewBox="0 0 100 100">
          <circle
            cx="50"
            cy="50"
            r="50"
            fill="#99ff99"
            class="tooltip-trigger"
            data-tooltip="Free: {{.HumanFree}} ({{.FreePercent}}%)"
          ></circle>
          <path
            d="{{.PieChart}}"
            fill="#ff9999"
            class="tooltip-trigger"
            data-tooltip="Used: {{.HumanUsed}} ({{.UsedPercent}}%)"
          ></path>
          <div class="disk-size">{{.HumanSize}}</div>
        </svg>
      </div>
      {{end}}
    </div>
    {{else if eq .View "columns"}}
    <div class="columns">
      {{range .DiskInfos}}
      <div class="column {{if .Ignore}}ignore{{end}}">
        <div class="column-name">{{.Device}}</div>
        <div
          class="column-used tooltip-trigger"
          style="height: {{.UsedPercent}}%; background-color: #ff9999;"
          data-tooltip="Used: {{.HumanUsed}}"
        >
          {{.HumanUsed}}
        </div>
        <div
          class="column-free tooltip-trigger"
          style="height: {{.FreePercent}}%; background-color: #99ff99;"
          data-tooltip="Free: {{.HumanFree}}"
        >
          {{.HumanFree}}
        </div>
        <div class="column-size">{{.HumanSize}}</div>
      </div>
      {{end}}
    </div>
    {{end}}
    <br />
    <a href="/ignore">Configure Ignore Disks</a>
    <div class="tooltip" id="tooltip"></div>
    <script>
      document.addEventListener("DOMContentLoaded", function () {
        const triggers = document.querySelectorAll(".tooltip-trigger");
        const tooltip = document.getElementById("tooltip");

        triggers.forEach((trigger) => {
          trigger.addEventListener("mouseenter", function () {
            tooltip.textContent = this.dataset.tooltip;
            tooltip.style.display = "block";
          });

          trigger.addEventListener("mouseleave", function () {
            tooltip.style.display = "none";
          });

          trigger.addEventListener("mousemove", function (e) {
            tooltip.style.left = e.pageX + 10 + "px";
            tooltip.style.top = e.pageY + 10 + "px";
          });
        });
      });
    </script>
  </body>
</html>
